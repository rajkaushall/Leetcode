
## [1504. Count Submatrices With All Ones](https://leetcode.com/problems/count-submatrices-with-all-ones/)
Given an  `m x n`  binary matrix  `mat`,  _return the number of  **submatrices**  that have all ones_.

**Example 1:**

![](https://assets.leetcode.com/uploads/2021/10/27/ones1-grid.jpg)

**Input:** mat = [[1,0,1],[1,1,0],[1,1,0]]
**Output:** 13
**Explanation:** 
There are 6 rectangles of side 1x1.
There are 2 rectangles of side 1x2.
There are 3 rectangles of side 2x1.
There is 1 rectangle of side 2x2. 
There is 1 rectangle of side 3x1.
Total number of rectangles = 6 + 2 + 3 + 1 + 1 = 13.

**Example 2:**

![](https://assets.leetcode.com/uploads/2021/10/27/ones2-grid.jpg)

**Input:** mat = [[0,1,1,0],[0,1,1,1],[1,1,1,0]]
**Output:** 24
**Explanation:** 
There are 8 rectangles of side 1x1.
There are 5 rectangles of side 1x2.
There are 2 rectangles of side 1x3. 
There are 4 rectangles of side 2x1.
There are 2 rectangles of side 2x2. 
There are 2 rectangles of side 3x1. 
There is 1 rectangle of side 3x2. 
Total number of rectangles = 8 + 5 + 2 + 4 + 2 + 2 + 1 = 24.

**Constraints:**

-   `1 <= m, n <= 150`
-   `mat[i][j]`  is either  `0`  or  `1`.

---

```cpp
class  Solution 
{
	public:
	int  numSubmat(vector<vector<int>>&  mat) 
	{
		int m = mat.size();
		int n = mat[0].size();

		vector<int> height(n, 0);

		int total = 0;
		for (int i = 0; i < m; i++) 
		{
			// Step 1: Update histogram heights row by row
			for (int j = 0; j < n; j++) 
			{
				if (mat[i][j] == 0) height[j] = 0;
				else  height[j] += 1;
			}
			// Step 2: Count rectangles ending at row i

			for (int j = 0; j < n; j++) 
			{
				int minHeight = height[j];
				for (int k = j; k >= 0; k--) 
				{
					if (height[k] == 0) break;
					minHeight = min(minHeight, height[k]);
					total += minHeight;
				}
			}
		}
		return total;
	}
};
```
